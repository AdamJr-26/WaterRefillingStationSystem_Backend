const {
  encryptPassword,
  comparePassword,
} = require("../../utils/password.util");
const mutation = require("../../data-access/mutation/index");
const query = require("../../data-access/query/index");
const { sendEmail, sendOTP } = require("../../utils/email/mailer");
const clientCofing = require("../../config/client.config");
const { validationResult } = require("express-validator");
const signIn = require("../../utils/jwt.sign");
// for register.controller
const responseUtil = require("../../utils/server.responses.util");
const constantUtils = require("../../utils/constant.util");
const crypto = require("crypto");

module.exports = {
  ...require("./checking.gmail")(query, responseUtil),
  ...require("./authorize.controller")(responseUtil),
  ...require("./verify.controller")(mutation, query, responseUtil),
  ...require("./register.controller")(
    mutation,
    sendEmail,
    clientCofing,
    responseUtil,
    constantUtils,
    validationResult,
    encryptPassword,
    sendOTP,
    crypto,
    query
  ),
  ...require("./login.controller")(
    mutation,
    query,
    sendEmail,
    clientCofing,
    responseUtil,
    constantUtils,
    validationResult,
    comparePassword,
    signIn
  ),
  ...require("./logout.controller")(),
  ...require("./update.controller")(
    mutation,
    query,
    comparePassword,
    encryptPassword,
    responseUtil
  ),
  ...require("./verification/send.otp")(
    mutation,
    query,
    crypto,
    clientCofing,
    responseUtil,
    sendOTP
  ),
  ...require("./verification/verify.otp")(query, responseUtil),
  ...require("./verification/send.verify.link")(
    mutation,
    query,
    crypto,
    clientCofing,
    responseUtil,
    sendEmail
  ),
  ...require("./verification/set.new.password")(
    mutation,
    query,
    responseUtil,
    encryptPassword,
    sendOTP,
    crypto
  ),
  ...require("./google.signin.controller")(
    query,
    responseUtil,
    comparePassword,
    signIn
  ),
};
